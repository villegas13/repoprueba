{"ast":null,"code":"import'./App.css';import{io}from'socket.io-client';import{useState,useEffect,useRef}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const socket=io('https://sistemareact.tutiendablog.com/');function App(){const[isConnected,setIsConnected]=useState(false);const[mensajes,setMensajes]=useState([]);const[nuevoMensaje,setNuevoMensaje]=useState('');const[usuario,setUsuario]=useState('');const inputRef=useRef(null);const messagesEndRef=useRef(null);// Scroll autom치tico al 칰ltimo mensaje\nconst scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};useEffect(()=>{scrollToBottom();},[mensajes]);// Login y conexi칩n\nuseEffect(()=>{var _prompt;// Pedimos nombre solo una vez\nconst nombre=((_prompt=prompt('쮺u치l es tu nombre?'))===null||_prompt===void 0?void 0:_prompt.trim())||'An칩nimo';setUsuario(nombre);const onConnect=()=>{setIsConnected(true);socket.emit('login',nombre);};socket.on('connect',onConnect);// Si ya est치 conectado cuando se monta el componente\nif(socket.connected){onConnect();}socket.on('disconnect',()=>{setIsConnected(false);});socket.on('chat message',msg=>{setMensajes(prev=>[...prev,msg]);});socket.on('user_joined',data=>{setMensajes(prev=>[...prev,{username:'Sistema',text:\"\".concat(data.username,\" se conect\\xF3\"),time:data.timestamp}]);});socket.on('user_left',data=>{setMensajes(prev=>[...prev,{username:'Sistema',text:\"\".concat(data.username,\" se desconect\\xF3\"),time:new Date().toLocaleTimeString()}]);});socket.on('load_messages',historial=>{setMensajes(historial);});return()=>{socket.off('connect',onConnect);socket.off('disconnect');socket.off('chat message');socket.off('user_joined');socket.off('user_left');socket.off('load_messages');};},[]);const enviarMensaje=e=>{var _inputRef$current;e.preventDefault();if(!nuevoMensaje.trim()||!isConnected)return;// Enviamos solo el texto (el servidor a침adir치 username y hora)\nsocket.emit('chat message',nuevoMensaje.trim());setNuevoMensaje('');(_inputRef$current=inputRef.current)===null||_inputRef$current===void 0?void 0:_inputRef$current.focus();};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Chat en Vivo\",' ',/*#__PURE__*/_jsx(\"span\",{style:{color:isConnected?'#22c55e':'#ef4444',fontSize:'1.1em'},children:isConnected?'游릭 Conectado':'游댮 Desconectado'})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Bienvenido, \",/*#__PURE__*/_jsx(\"strong\",{children:usuario})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mensajes\",children:[mensajes.map((msg,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"mensaje \".concat(msg.username===usuario?'propio':'',\" \").concat(msg.username==='Sistema'?'sistema':''),children:[msg.username!=='Sistema'&&/*#__PURE__*/_jsx(\"span\",{className:\"usuario\",children:msg.username}),/*#__PURE__*/_jsx(\"span\",{className:\"hora\",children:msg.time||new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})}),/*#__PURE__*/_jsx(\"p\",{children:msg.text||msg.mensaje})]},i)),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:enviarMensaje,className:\"input-area\",children:[/*#__PURE__*/_jsx(\"input\",{ref:inputRef,type:\"text\",value:nuevoMensaje,onChange:e=>setNuevoMensaje(e.target.value),placeholder:\"Escribe tu mensaje...\",disabled:!isConnected,autoFocus:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:!isConnected,children:\"Enviar\"})]})]});}export default App;","map":{"version":3,"names":["io","useState","useEffect","useRef","jsx","_jsx","jsxs","_jsxs","socket","App","isConnected","setIsConnected","mensajes","setMensajes","nuevoMensaje","setNuevoMensaje","usuario","setUsuario","inputRef","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","_prompt","nombre","prompt","trim","onConnect","emit","on","connected","msg","prev","data","username","text","concat","time","timestamp","Date","toLocaleTimeString","historial","off","enviarMensaje","e","_inputRef$current","preventDefault","focus","className","children","style","color","fontSize","map","i","hour","minute","mensaje","ref","onSubmit","type","value","onChange","target","placeholder","disabled","autoFocus"],"sources":["C:/laragon/www/reactapp/client/src/App.js"],"sourcesContent":["import './App.css';\nimport { io } from 'socket.io-client';\nimport { useState, useEffect, useRef } from 'react';\n\nconst socket = io('https://sistemareact.tutiendablog.com/');\n\nfunction App() {\n  const [isConnected, setIsConnected] = useState(false);\n  const [mensajes, setMensajes] = useState([]);\n  const [nuevoMensaje, setNuevoMensaje] = useState('');\n  const [usuario, setUsuario] = useState('');\n  const inputRef = useRef(null);\n  const messagesEndRef = useRef(null);\n\n  // Scroll autom치tico al 칰ltimo mensaje\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [mensajes]);\n\n  // Login y conexi칩n\n  useEffect(() => {\n    // Pedimos nombre solo una vez\n    const nombre = prompt('쮺u치l es tu nombre?')?.trim() || 'An칩nimo';\n    setUsuario(nombre);\n\n    const onConnect = () => {\n      setIsConnected(true);\n      socket.emit('login', nombre);\n    };\n\n    socket.on('connect', onConnect);\n\n    // Si ya est치 conectado cuando se monta el componente\n    if (socket.connected) {\n      onConnect();\n    }\n\n    socket.on('disconnect', () => {\n      setIsConnected(false);\n    });\n\n    socket.on('chat message', (msg) => {\n      setMensajes((prev) => [...prev, msg]);\n    });\n\n    socket.on('user_joined', (data) => {\n      setMensajes((prev) => [\n        ...prev,\n        { username: 'Sistema', text: `${data.username} se conect칩`, time: data.timestamp },\n      ]);\n    });\n\n    socket.on('user_left', (data) => {\n      setMensajes((prev) => [\n        ...prev,\n        { username: 'Sistema', text: `${data.username} se desconect칩`, time: new Date().toLocaleTimeString() },\n      ]);\n    });\n\n    socket.on('load_messages', (historial) => {\n      setMensajes(historial);\n    });\n\n    return () => {\n      socket.off('connect', onConnect);\n      socket.off('disconnect');\n      socket.off('chat message');\n      socket.off('user_joined');\n      socket.off('user_left');\n      socket.off('load_messages');\n    };\n  }, []);\n\n  const enviarMensaje = (e) => {\n    e.preventDefault();\n    if (!nuevoMensaje.trim() || !isConnected) return;\n\n    // Enviamos solo el texto (el servidor a침adir치 username y hora)\n    socket.emit('chat message', nuevoMensaje.trim());\n\n    setNuevoMensaje('');\n    inputRef.current?.focus();\n  };\n\n  return (\n    <div className=\"App\">\n      <div className=\"header\">\n        <h2>\n          Chat en Vivo{' '}\n          <span style={{ color: isConnected ? '#22c55e' : '#ef4444', fontSize: '1.1em' }}>\n            {isConnected ? '游릭 Conectado' : '游댮 Desconectado'}\n          </span>\n        </h2>\n        <p>\n          Bienvenido, <strong>{usuario}</strong>\n        </p>\n      </div>\n\n      <div className=\"mensajes\">\n        {mensajes.map((msg, i) => (\n          <div\n            key={i}\n            className={`mensaje ${msg.username === usuario ? 'propio' : ''} ${\n              msg.username === 'Sistema' ? 'sistema' : ''\n            }`}\n          >\n            {msg.username !== 'Sistema' && <span className=\"usuario\">{msg.username}</span>}\n            <span className=\"hora\">\n              {msg.time || new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n            </span>\n            <p>{msg.text || msg.mensaje}</p>\n          </div>\n        ))}\n        <div ref={messagesEndRef} />\n      </div>\n\n      <form onSubmit={enviarMensaje} className=\"input-area\">\n        <input\n          ref={inputRef}\n          type=\"text\"\n          value={nuevoMensaje}\n          onChange={(e) => setNuevoMensaje(e.target.value)}\n          placeholder=\"Escribe tu mensaje...\"\n          disabled={!isConnected}\n          autoFocus\n        />\n        <button type=\"submit\" disabled={!isConnected}>\n          Enviar\n        </button>\n      </form>\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}